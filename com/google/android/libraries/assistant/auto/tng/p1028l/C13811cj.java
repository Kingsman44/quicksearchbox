package com.google.android.libraries.assistant.auto.tng.p1028l;

import android.app.ActivityManager;
import androidx.p104d.p105a.C2164c;
import androidx.p104d.p105a.C2169h;
import com.google.android.libraries.assistant.auto.tng.p1028l.p1033d.C13829a;
import com.google.android.libraries.assistant.auto.tng.p1028l.p1033d.C13848b;
import com.google.android.libraries.p1730f.C21370a;
import com.google.android.libraries.search.p2871b.p2872a.p2875c.C37179a;
import com.google.apps.tiktok.concurrent.C46459k;
import com.google.apps.tiktok.tracing.C47558bi;
import com.google.apps.tiktok.tracing.C47810es;
import com.google.apps.tiktok.tracing.C47831fm;
import com.google.apps.tiktok.tracing.contrib.p3700b.C47633f;
import com.google.apps.tiktok.tracing.contrib.p3700b.C47638k;
import com.google.common.p4526f.C58976aa;
import com.google.common.p4526f.C59052c;
import com.google.common.p4526f.C59071e;
import com.google.common.p4526f.C59104x;
import com.google.common.p4526f.p4527a.C58975e;
import com.google.common.util.concurrent.C60826bg;
import com.google.common.util.concurrent.C60856cj;
import com.google.common.util.concurrent.C60870cx;
import com.google.common.util.concurrent.C60888db;
import com.google.common.util.concurrent.C60922j;
import java.util.ArrayList;
import java.util.concurrent.Executor;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.atomic.AtomicBoolean;
import p3186j$.util.Optional;
import p5460g.p5461a.C69464a;

/* renamed from: com.google.android.libraries.assistant.auto.tng.l.cj */
/* compiled from: PG */
public final class C13811cj implements C13736at {

    /* renamed from: a */
    public static final C59071e f42039a = C59071e.m91332i("com.google.android.libraries.assistant.auto.tng.l.cj");

    /* renamed from: A */
    public Optional f42040A = Optional.empty();

    /* renamed from: B */
    public Optional f42041B = Optional.empty();

    /* renamed from: C */
    public final C13722af f42042C;

    /* renamed from: D */
    public final C13863do f42043D;

    /* renamed from: E */
    public final C69464a f42044E;

    /* renamed from: F */
    private final C60870cx f42045F;

    /* renamed from: G */
    private final C60870cx f42046G;

    /* renamed from: H */
    private final C69464a f42047H;

    /* renamed from: I */
    private final C69464a f42048I;

    /* renamed from: J */
    private final C69464a f42049J;

    /* renamed from: K */
    private final C69464a f42050K;

    /* renamed from: L */
    private final Executor f42051L;

    /* renamed from: M */
    private final C13873dy f42052M;

    /* renamed from: N */
    private final C69464a f42053N;

    /* renamed from: O */
    private final C69464a f42054O;

    /* renamed from: P */
    private final C69464a f42055P;

    /* renamed from: Q */
    private final C21370a f42056Q;

    /* renamed from: R */
    private boolean f42057R;

    /* renamed from: b */
    public final C60870cx f42058b;

    /* renamed from: c */
    public final C60870cx f42059c;

    /* renamed from: d */
    public final C13858dj f42060d;

    /* renamed from: e */
    public final C13814cm f42061e;

    /* renamed from: f */
    public final C13874e f42062f;

    /* renamed from: g */
    public final C60888db f42063g;

    /* renamed from: h */
    public final C13893x f42064h;

    /* renamed from: i */
    public final C69464a f42065i;

    /* renamed from: j */
    public final C69464a f42066j;

    /* renamed from: k */
    public final C69464a f42067k;

    /* renamed from: l */
    public final C69464a f42068l;

    /* renamed from: m */
    public final ActivityManager f42069m;

    /* renamed from: n */
    public final AtomicBoolean f42070n = new AtomicBoolean(false);

    /* renamed from: o */
    public final AtomicBoolean f42071o = new AtomicBoolean(false);

    /* renamed from: p */
    public final AtomicBoolean f42072p = new AtomicBoolean(false);

    /* renamed from: q */
    public final C69464a f42073q;

    /* renamed from: r */
    public final C13848b f42074r;

    /* renamed from: s */
    public C2164c f42075s;

    /* renamed from: t */
    public C2164c f42076t;

    /* renamed from: u */
    public C2164c f42077u;

    /* renamed from: v */
    public C2164c f42078v;

    /* renamed from: w */
    public C13889t f42079w;

    /* renamed from: x */
    public C13753bf f42080x;

    /* renamed from: y */
    public C13753bf f42081y;

    /* renamed from: z */
    public Optional f42082z = Optional.empty();

    public C13811cj(C13848b bVar, C13858dj djVar, C13874e eVar, C69464a aVar, C69464a aVar2, C69464a aVar3, C69464a aVar4, C60888db dbVar, Executor executor, C13814cm cmVar, C13894y yVar, C13873dy dyVar, C69464a aVar5, C69464a aVar6, C69464a aVar7, C69464a aVar8, C69464a aVar9, C69464a aVar10, C69464a aVar11, C69464a aVar12, C21370a aVar13, C13723ag agVar, C13864dp dpVar, C69464a aVar14, ActivityManager activityManager) {
        this.f42074r = bVar;
        this.f42060d = djVar;
        this.f42047H = aVar2;
        this.f42048I = aVar;
        this.f42050K = aVar3;
        this.f42049J = aVar4;
        this.f42061e = cmVar;
        this.f42062f = eVar;
        this.f42063g = dbVar;
        this.f42051L = executor;
        this.f42045F = C2169h.m6027a(new C13765br(this));
        this.f42075s.getClass();
        this.f42058b = C2169h.m6027a(new C13766bs(this));
        this.f42076t.getClass();
        this.f42046G = C2169h.m6027a(new C13767bt(this));
        this.f42078v.getClass();
        this.f42059c = C2169h.m6027a(new C13768bu(this));
        this.f42077u.getClass();
        this.f42064h = yVar.mo21345a(bVar, new C13769bv(this));
        this.f42052M = dyVar;
        this.f42053N = aVar5;
        this.f42065i = aVar6;
        this.f42066j = aVar7;
        this.f42067k = aVar8;
        this.f42054O = aVar9;
        this.f42055P = aVar10;
        this.f42068l = aVar11;
        this.f42057R = false;
        this.f42073q = aVar12;
        this.f42056Q = aVar13;
        C13722af a = agVar.mo21232a();
        this.f42042C = a;
        this.f42043D = dpVar.mo21316a(a);
        this.f42044E = aVar14;
        this.f42069m = activityManager;
    }

    /* renamed from: a */
    public final C60870cx mo21236a() {
        C59071e eVar = f42039a;
        C59104x b = eVar.mo56224b();
        b.mo56378ag(C58975e.f156826a, "HybridFOPolicy");
        ((C59052c) ((C59052c) b).mo56372aa(45017)).mo56386p("#cancel");
        this.f42070n.set(true);
        C2164c cVar = this.f42078v;
        cVar.getClass();
        cVar.mo5438c();
        C2164c cVar2 = this.f42076t;
        cVar2.getClass();
        cVar2.mo5438c();
        C2164c cVar3 = this.f42077u;
        cVar3.getClass();
        cVar3.mo5438c();
        this.f42060d.mo21309d(true);
        C13889t tVar = this.f42079w;
        if (tVar != null) {
            tVar.f42305a.cancel(false);
        }
        mo21265f();
        ArrayList arrayList = new ArrayList();
        C13753bf bfVar = this.f42081y;
        if (bfVar != null) {
            arrayList.add(bfVar.mo21248e());
            C59104x b2 = eVar.mo56224b();
            b2.mo56378ag(C58975e.f156826a, "HybridFOPolicy");
            ((C59052c) ((C59052c) b2).mo56372aa(45019)).mo56386p("cancelling online");
        }
        C13753bf bfVar2 = this.f42080x;
        if (bfVar2 != null) {
            arrayList.add(bfVar2.mo21248e());
            C59104x b3 = eVar.mo56224b();
            b3.mo56378ag(C58975e.f156826a, "HybridFOPolicy");
            ((C59052c) ((C59052c) b3).mo56372aa(45018)).mo56386p("cancelling offline");
        }
        return C60856cj.m92901j(C47638k.m84750a(arrayList).mo51520a(C13758bk.f41932a, this.f42063g));
    }

    /* renamed from: b */
    public final C60870cx mo21237b() {
        return this.f42046G;
    }

    /* renamed from: c */
    public final C60870cx mo21238c(C13829a aVar, C13755bh bhVar) {
        C47558bi a;
        Throwable th;
        C60870cx c;
        C47558bi a2;
        Throwable th2;
        Long l;
        C13829a aVar2 = aVar;
        C13755bh bhVar2 = bhVar;
        C47558bi a3 = C47831fm.m85006a("HybridFetchOrchestratorPolicy.orchestrate");
        try {
            C58976aa aaVar = C58975e.f156826a;
            if (aVar.mo21274e()) {
                long a4 = aVar.mo21270a();
                this.f42057R = false;
                if (a4 > 0 && ((Long) this.f42054O.mo17428b()).longValue() > 0 && this.f42056Q.mo26871c() - a4 > ((Long) this.f42054O.mo17428b()).longValue()) {
                    this.f42057R = true;
                    this.f42061e.f42086b.mo19974a(C37179a.f97422U);
                }
                if (((Boolean) this.f42053N.mo17428b()).booleanValue()) {
                    C13773bz bzVar = new C13773bz(this);
                    C13873dy dyVar = this.f42052M;
                    if (a4 <= 0) {
                        a4 = this.f42056Q.mo26871c();
                    }
                    Optional of = Optional.m71637of(dyVar.mo21327a(3, a4, this.f42057R, this.f42063g, bzVar));
                    this.f42041B = of;
                    ((C13872dx) of.get()).mo21325c();
                }
            }
            a = C47831fm.m85006a("HybridFetchOrchestratorPolicy.getOnlineFulfillment");
            if (this.f42070n.get()) {
                c = C60856cj.m92898g();
            } else {
                C13753bf c2 = bhVar2.mo21252c(aVar2, new C13810ci(this, aVar.mo21272c(), aVar.mo21271b()));
                this.f42081y = c2;
                c = c2.mo21241c();
                C13812ck ckVar = new C13812ck(this.f42061e);
                C60856cj.m92911t(c, C47810es.m84974n(ckVar), C60826bg.f164896a);
                a.mo51417a(c);
            }
            a.close();
            a2 = C47831fm.m85006a("HybridFetchOrchestratorPolicy.getOfflineFulfillment");
            if (this.f42057R) {
                l = (Long) this.f42055P.mo17428b();
            } else {
                l = (Long) this.f42048I.mo17428b();
            }
            long longValue = l.longValue();
            if (!aVar.mo21274e()) {
                longValue = ((Long) this.f42049J.mo17428b()).longValue();
            }
            C13771bx bxVar = new C13771bx(this);
            C46459k.m82829b(C60856cj.m92902k(C47810es.m84965e(bxVar), longValue, TimeUnit.MILLISECONDS, this.f42063g), "offlineScheduler failed", new Object[0]);
            C60870cx cxVar = this.f42045F;
            C13772by byVar = new C13772by(this, bhVar2, aVar2);
            C60870cx h = C60922j.m93045h(cxVar, C47810es.m84966f(byVar), this.f42051L);
            C13803cb cbVar = new C13803cb(this);
            C60856cj.m92911t(h, C47810es.m84974n(cbVar), C60826bg.f164896a);
            C60870cx a5 = C47638k.m84751b(h, this.f42058b).mo51520a(new C13757bj(h), C60826bg.f164896a);
            a2.mo51417a(a5);
            a2.close();
            C47633f f = C47633f.m84733g(c).mo51516i(new C13761bn(this, a5), C60826bg.f164896a).mo51514f(Exception.class, new C13762bo(this, C47633f.m84733g(a5).mo51516i(new C13759bl(this, c, aVar2, a5), C60826bg.f164896a).mo51514f(Exception.class, new C13760bm(this, aVar2), C60826bg.f164896a)), C60826bg.f164896a);
            C13889t a6 = C13853de.m30140a(C47638k.m84751b(f, c, a5).mo51520a(new C13763bp(f), C60826bg.f164896a), this.f42047H, this.f42063g, this.f42061e.f42086b);
            this.f42079w = a6;
            C60870cx cxVar2 = a6.f42305a;
            C13804cc ccVar = new C13804cc(this);
            C60856cj.m92911t(cxVar2, C47810es.m84974n(ccVar), C60826bg.f164896a);
            if (!aVar.mo21274e()) {
                mo21266g();
            }
            a3.mo51417a(cxVar2);
            a3.close();
            return cxVar2;
            throw th;
            throw th2;
        } catch (Throwable th3) {
            Throwable th4 = th3;
            try {
                a3.close();
            } catch (Throwable th5) {
                C13756bi.m30013a(th4, th5);
            }
            throw th4;
        }
    }

    /* renamed from: d */
    public final void mo21263d(C13753bf bfVar) {
        C58976aa aaVar = C58975e.f156826a;
        if (!this.f42070n.get()) {
            bfVar.getClass();
            C60870cx b = bfVar.mo21240b();
            C13806ce ceVar = new C13806ce(this);
            C60856cj.m92911t(b, C47810es.m84974n(ceVar), C60826bg.f164896a);
        }
    }

    /* renamed from: e */
    public final void mo21264e() {
        if (this.f42080x != null && this.f42072p.get() && this.f42071o.get()) {
            C13753bf bfVar = this.f42080x;
            bfVar.getClass();
            C60870cx f = bfVar.mo21249f();
            C13805cd cdVar = new C13805cd(this);
            C60856cj.m92911t(f, C47810es.m84974n(cdVar), C60826bg.f164896a);
        }
    }

    /* renamed from: f */
    public final void mo21265f() {
        if (this.f42041B.isPresent()) {
            ((C13872dx) this.f42041B.get()).mo21326d();
            C58976aa aaVar = C58975e.f156826a;
        }
    }

    /* renamed from: g */
    public final void mo21266g() {
        this.f42063g.mo29165e(new C13764bq(this), ((Long) this.f42050K.mo17428b()).longValue(), TimeUnit.MILLISECONDS);
        C13889t tVar = this.f42079w;
        if (tVar != null) {
            tVar.mo21340b();
        }
    }
}
