package com.google.android.apps.gsa.staticplugins.bisto.p7465ac.p7473g;

import android.accounts.Account;
import android.content.Context;
import com.google.android.apps.gsa.nga.api.C74723ca;
import com.google.android.apps.gsa.nga.api.C74725ce;
import com.google.android.apps.gsa.nga.api.a.ad;
import com.google.android.apps.gsa.nga.api.a.bn;
import com.google.android.apps.gsa.nga.api.a.bw;
import com.google.android.apps.gsa.nga.api.a.by;
import com.google.android.apps.gsa.nga.api.a.cb;
import com.google.android.apps.gsa.nga.api.a.cd;
import com.google.android.apps.gsa.nga.api.a.cf;
import com.google.android.apps.gsa.nga.api.a.u;
import com.google.android.apps.gsa.nga.api.a.w;
import com.google.android.apps.gsa.nga.api.bh;
import com.google.android.apps.gsa.nga.api.p5883a.C74674bv;
import com.google.android.apps.gsa.nga.api.p5883a.C74675ca;
import com.google.android.apps.gsa.nga.shared.p6339f.p6341b.C81030c;
import com.google.android.apps.gsa.nga.shared.p6339f.p6342c.C81049g;
import com.google.android.apps.gsa.nga.shared.p6339f.p6342c.C81050h;
import com.google.android.apps.gsa.shared.bisto.C89656k;
import com.google.android.apps.gsa.staticplugins.bisto.p7465ac.p7474h.C95007y;
import com.google.android.apps.gsa.staticplugins.bisto.p7465ac.p7477k.C95021c;
import com.google.android.apps.gsa.staticplugins.bisto.p7479ae.C95130w;
import com.google.android.apps.gsa.staticplugins.bisto.p7479ae.p7480a.C95058u;
import com.google.android.apps.search.assistant.surfaces.bisto.p9390c.p9392b.C124548d;
import com.google.android.apps.search.assistant.surfaces.bisto.p9403d.C124620am;
import com.google.android.apps.search.assistant.surfaces.bisto.p9403d.C124719q;
import com.google.android.libraries.search.p2904c.C37512ds;
import com.google.android.libraries.search.p2904c.C37513dt;
import com.google.android.libraries.search.p2904c.C37514du;
import com.google.android.libraries.search.p2904c.C37672hs;
import com.google.android.libraries.search.p2904c.p2907ab.C37336c;
import com.google.assistant.p3739a.p3740a.C48041ab;
import com.google.assistant.p3739a.p3740a.C48090bx;
import com.google.assistant.p3739a.p3740a.C48098ce;
import com.google.assistant.p3739a.p3740a.C48111h;
import com.google.assistant.p3897e.p3899b.p3901b.C50877d;
import com.google.assistant.p3897e.p3921j.C51717bo;
import com.google.assistant.p3897e.p3921j.C51718bp;
import com.google.assistant.p3897e.p3921j.C52427ri;
import com.google.assistant.p3897e.p3921j.C52428rj;
import com.google.assistant.p3996t.p3997a.C53481h;
import com.google.common.p4526f.C59052c;
import com.google.common.p4526f.C59071e;
import com.google.common.p4526f.C59104x;
import com.google.common.p4526f.p4527a.C58975e;
import com.google.common.util.concurrent.C60856cj;
import com.google.common.util.concurrent.C60870cx;
import java.util.concurrent.atomic.AtomicBoolean;
import p3186j$.util.Optional;

/* renamed from: com.google.android.apps.gsa.staticplugins.bisto.ac.g.a */
/* compiled from: PG */
public final class C94964a implements C95058u, C74723ca {

    /* renamed from: a */
    public static final C59071e f265651a = C59071e.m91332i("com.google.android.apps.gsa.staticplugins.bisto.ac.g.a");

    /* renamed from: b */
    public final C94976m f265652b;

    /* renamed from: c */
    public final C94966c f265653c;

    /* renamed from: d */
    public final bh f265654d;

    /* renamed from: e */
    public final C74725ce f265655e;

    /* renamed from: f */
    public final Optional f265656f;

    /* renamed from: g */
    public final C94980q f265657g;

    /* renamed from: h */
    public Optional f265658h = Optional.empty();

    /* renamed from: i */
    public Optional f265659i = Optional.empty();

    /* renamed from: j */
    public boolean f265660j;

    /* renamed from: k */
    public Optional f265661k = Optional.empty();

    /* renamed from: l */
    public Optional f265662l = Optional.empty();

    /* renamed from: m */
    public boolean f265663m = false;

    /* renamed from: n */
    public final C81030c f265664n;

    /* renamed from: o */
    private final Context f265665o;

    /* renamed from: p */
    private final C95007y f265666p;

    /* renamed from: q */
    private final C95021c f265667q;

    /* renamed from: r */
    private final AtomicBoolean f265668r = new AtomicBoolean(false);

    /* renamed from: s */
    private final C89656k f265669s;

    /* renamed from: t */
    private Optional f265670t = Optional.empty();

    /* renamed from: u */
    private C48098ce f265671u = C48098ce.ASSISTANT_ERROR_CODE_UNSPECIFIED;

    public C94964a(Context context, C94976m mVar, C94966c cVar, bh bhVar, C74725ce ceVar, C95007y yVar, Optional optional, C94980q qVar, C81030c cVar2, C95021c cVar3, C89656k kVar) {
        this.f265665o = context;
        this.f265652b = mVar;
        this.f265653c = cVar;
        this.f265654d = bhVar;
        this.f265655e = ceVar;
        this.f265666p = yVar;
        this.f265656f = optional;
        this.f265667q = cVar3;
        this.f265657g = qVar;
        this.f265664n = cVar2;
        this.f265669s = kVar;
    }

    /* renamed from: k */
    private final void m156782k() {
        this.f265659i = Optional.empty();
        this.f265660j = false;
        this.f265668r.set(false);
        this.f265670t = Optional.empty();
        this.f265661k = Optional.empty();
        this.f265662l = Optional.empty();
        this.f265663m = false;
        this.f265666p.mo88815f(this.f265671u);
        this.f265671u = C48098ce.ASSISTANT_ERROR_CODE_UNSPECIFIED;
    }

    /* renamed from: l */
    private final boolean m156783l(C37672hs hsVar) {
        return this.f265659i.isPresent() && ((C37672hs) this.f265659i.get()).equals(hsVar);
    }

    /* renamed from: m */
    private final boolean m156784m(C37672hs hsVar) {
        return this.f265659i.isPresent() && ((C37672hs) this.f265659i.get()).equals(hsVar);
    }

    /* renamed from: a */
    public final C37336c mo71067a(C37672hs hsVar) {
        C59104x b = f265651a.mo56224b();
        b.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
        ((C59052c) ((C59052c) b).mo56372aa(17713)).mo56386p("#startListening");
        C37336c c = this.f265652b.mo88881c(false);
        this.f265659i = Optional.m71637of(hsVar);
        this.f265660j = true;
        this.f265666p.mo88826q();
        return c;
    }

    /* renamed from: b */
    public final C60870cx mo71068b(C37672hs hsVar) {
        C59071e eVar = f265651a;
        C59104x b = eVar.mo56224b();
        b.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
        ((C59052c) ((C59052c) b).mo56372aa(17714)).mo56386p("#stopListening");
        if (m156783l(hsVar)) {
            return this.f265652b.mo88883d(false);
        }
        C59104x d = eVar.mo56226d();
        d.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
        ((C59052c) ((C59052c) d).mo56372aa(17715)).mo56387q("stopListening called for unknown invocation: %s", hsVar.f100059b);
        C37513dt dtVar = (C37513dt) C37514du.f99629c.createBuilder();
        C37512ds dsVar = C37512ds.UNKNOWN_CLOSING_FAILURE;
        dtVar.copyOnWrite();
        C37514du duVar = (C37514du) dtVar.instance;
        duVar.f99632b = Integer.valueOf(dsVar.f99628K);
        duVar.f99631a = 2;
        return C60856cj.m92900i((C37514du) dtVar.build());
    }

    /* renamed from: c */
    public final Optional mo71094c(C37672hs hsVar) {
        C59104x b = f265651a.mo56224b();
        b.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
        ((C59052c) ((C59052c) b).mo56372aa(17716)).mo56386p("#onRohanFollowOn");
        if (!m156784m(hsVar)) {
            return Optional.empty();
        }
        cf c = this.f265653c.mo88878c();
        this.f265659i = Optional.m71637of(hsVar);
        this.f265660j = true;
        this.f265666p.mo88826q();
        return Optional.m71637of(c);
    }

    /* renamed from: d */
    public final void mo71095d(ad adVar) {
        C37672hs hsVar = adVar.c;
        if (hsVar == null || !m156784m(hsVar)) {
            C59104x d = f265651a.mo56226d();
            d.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
            ((C59052c) ((C59052c) d).mo56372aa(17722)).mo56386p("#onError was called for unknown invocation token.");
            return;
        }
        C59104x d2 = f265651a.mo56226d();
        d2.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
        ((C59052c) ((C59052c) d2).mo56372aa(17723)).mo56386p("#onError");
        this.f265671u = C48098ce.QUERY_FAILED;
        m156782k();
    }

    /* renamed from: e */
    public final void mo71096e(bw bwVar) {
        C37672hs hsVar = bwVar.a;
        if (hsVar == null || !m156784m(hsVar)) {
            C59104x d = f265651a.mo56226d();
            d.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
            ((C59052c) ((C59052c) d).mo56372aa(17724)).mo56386p("#onErrorAfterAcceptingInvocation for unknown invocation token.");
            return;
        }
        int b = C74674bv.m120744b(bwVar.b);
        if (b != 0 && b == 5) {
            this.f265671u = C48098ce.ARBITRATION_LOSS;
        }
        m156782k();
    }

    /* renamed from: f */
    public final void mo71097f(cb cbVar) {
        cd cdVar;
        bn bnVar;
        u uVar;
        C50877d dVar;
        by byVar;
        if (!this.f265659i.isEmpty()) {
            C37672hs hsVar = cbVar.c;
            if (hsVar == null || hsVar.equals(this.f265659i.get())) {
                int i = cbVar.a;
                int a = C74675ca.m120745a(i);
                int i2 = a - 1;
                if (a == 0) {
                    throw null;
                } else if (i2 == 1) {
                    C59104x b = f265651a.mo56224b();
                    b.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
                    ((C59052c) ((C59052c) b).mo56372aa(17726)).mo56386p("#onQueryStatus: Listening");
                } else if (i2 == 2) {
                    if (i == 4) {
                        cdVar = (cd) cbVar.b;
                    } else {
                        cdVar = cd.b;
                    }
                    String str = cdVar.a;
                    if (this.f265669s.mo83553h("bistoSpeechTestingMode")) {
                        C59104x b2 = f265651a.mo56224b();
                        b2.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
                        ((C59052c) ((C59052c) b2).mo56372aa(17731)).mo56389s("Recognized Text: %s", str);
                    }
                    C59104x b3 = f265651a.mo56224b();
                    b3.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
                    ((C59052c) ((C59052c) b3).mo56372aa(17730)).mo56386p("#onQueryStatus: Recognition");
                    this.f265666p.mo88811b(str);
                } else if (i2 != 3) {
                    switch (i2) {
                        case 7:
                            C59104x b4 = f265651a.mo56224b();
                            b4.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
                            ((C59052c) ((C59052c) b4).mo56372aa(17727)).mo56386p("#onQueryStatus: Executing");
                            this.f265668r.set(true);
                            return;
                        case 8:
                            C59104x b5 = f265651a.mo56224b();
                            b5.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
                            ((C59052c) ((C59052c) b5).mo56372aa(17725)).mo56386p("#onQueryStatus: Idle");
                            if (this.f265671u == C48098ce.ASSISTANT_ERROR_CODE_UNSPECIFIED && !this.f265668r.get()) {
                                this.f265671u = C48098ce.QUERY_FAILED;
                            }
                            m156782k();
                            return;
                        case 9:
                            C59104x b6 = f265651a.mo56224b();
                            b6.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
                            ((C59052c) ((C59052c) b6).mo56372aa(17728)).mo56386p("#onQueryStatus: PartialRecognition");
                            C95007y yVar = this.f265666p;
                            if (cbVar.a == 11) {
                                bnVar = (bn) cbVar.b;
                            } else {
                                bnVar = bn.b;
                            }
                            yVar.mo88825p(bnVar.a, false, 0);
                            return;
                        case 10:
                            C59071e eVar = f265651a;
                            C59104x b7 = eVar.mo56224b();
                            b7.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
                            ((C59052c) ((C59052c) b7).mo56372aa(17732)).mo56386p("#onQueryStatus: GacsExecute");
                            if (cbVar.a == 12) {
                                uVar = (u) cbVar.b;
                            } else {
                                uVar = u.c;
                            }
                            int i3 = uVar.a;
                            if (i3 == 1) {
                                this.f265666p.mo88823n(((w) uVar.b).a.mo59174N(), (String) null);
                                return;
                            } else if (i3 == 2) {
                                C59104x b8 = eVar.mo56224b();
                                b8.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
                                ((C59052c) ((C59052c) b8).mo56372aa(17733)).mo56386p("#onQueryStatus: GacsExecuteClientOp");
                                if (uVar.a == 2) {
                                    dVar = (C50877d) uVar.b;
                                } else {
                                    dVar = C50877d.f132472c;
                                }
                                if ((dVar.f132474a & 1) != 0) {
                                    C95007y yVar2 = this.f265666p;
                                    C48111h hVar = dVar.f132475b;
                                    if (hVar == null) {
                                        hVar = C48111h.f124520a;
                                    }
                                    yVar2.mo88816g(hVar, (String) null);
                                    this.f265668r.set(true);
                                    return;
                                }
                                C59104x b9 = eVar.mo56224b();
                                b9.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
                                ((C59052c) ((C59052c) b9).mo56372aa(17734)).mo56386p("GacsExecuteClientOp received without response");
                                return;
                            } else {
                                return;
                            }
                        case 11:
                            C59104x b10 = f265651a.mo56224b();
                            b10.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
                            ((C59052c) ((C59052c) b10).mo56372aa(17735)).mo56386p("#onQueryStatus: QueryRequestId");
                            if (cbVar.a == 13) {
                                byVar = (by) cbVar.b;
                            } else {
                                byVar = by.b;
                            }
                            this.f265670t = Optional.m71637of(Long.valueOf(byVar.a));
                            if (!this.f265660j) {
                                mo88874i();
                                return;
                            }
                            return;
                        default:
                            return;
                    }
                } else {
                    C59104x b11 = f265651a.mo56224b();
                    b11.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
                    ((C59052c) ((C59052c) b11).mo56372aa(17729)).mo56386p("#onQueryStatus: NoSpeechDetected");
                    this.f265671u = C48098ce.NO_SPEECH;
                }
            } else {
                C59104x d = f265651a.mo56226d();
                d.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
                C59052c cVar = (C59052c) ((C59052c) d).mo56372aa(17736);
                C37672hs hsVar2 = cbVar.c;
                if (hsVar2 == null) {
                    hsVar2 = C37672hs.f100056c;
                }
                cVar.mo56387q("onQueryStatus for unknown invocation: %s", hsVar2.f100059b);
            }
        } else {
            C59104x d2 = f265651a.mo56226d();
            d2.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
            ((C59052c) ((C59052c) d2).mo56372aa(17737)).mo56386p("onQueryStatus: no current token.");
        }
    }

    /* renamed from: g */
    public final C81050h mo88872g(C124548d dVar, C48090bx bxVar) {
        if (dVar == null) {
            C59104x c = f265651a.mo56225c();
            c.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
            ((C59052c) ((C59052c) c).mo56372aa(17712)).mo56386p("null deviceInfo");
            return C81050h.f222144i;
        }
        C81049g gVar = (C81049g) C81050h.f222144i.createBuilder();
        Context context = this.f265665o;
        String M = dVar.mo106472M();
        String V = dVar.mo106481V();
        C124719q k = dVar.mo106513k();
        C48041ab abVar = bxVar.f124457e;
        if (abVar == null) {
            abVar = C48041ab.f124355c;
        }
        C53481h hVar = abVar.f124357a;
        if (hVar == null) {
            hVar = C53481h.f140358b;
        }
        String d = C95130w.m157242d(context, M, V, k, hVar.f140360a);
        gVar.copyOnWrite();
        C81050h hVar2 = (C81050h) gVar.instance;
        d.getClass();
        hVar2.f222146a |= 1;
        hVar2.f222147b = d;
        if (!dVar.mo106484Y()) {
            boolean ab = dVar.mo106488ab();
            gVar.copyOnWrite();
            C81050h hVar3 = (C81050h) gVar.instance;
            hVar3.f222146a |= 32;
            hVar3.f222152g = ab;
        }
        String O = dVar.mo106474O();
        if (O != null) {
            gVar.copyOnWrite();
            C81050h hVar4 = (C81050h) gVar.instance;
            hVar4.f222146a |= 2;
            hVar4.f222148c = O;
        }
        C51717bo boVar = (C51717bo) C51718bp.f135685d.createBuilder();
        boVar.copyOnWrite();
        C51718bp bpVar = (C51718bp) boVar.instance;
        bxVar.getClass();
        bpVar.f135688b = bxVar;
        bpVar.f135687a |= 1;
        Account account = this.f265667q.f265849b;
        if (account != null) {
            C124620am o = dVar.mo106517o(account);
            if ((o.f343763a & 1) != 0) {
                C52427ri riVar = (C52427ri) C52428rj.f137558m.createBuilder();
                String str = o.f343764b;
                riVar.copyOnWrite();
                C52428rj rjVar = (C52428rj) riVar.instance;
                str.getClass();
                rjVar.f137560a |= 4;
                rjVar.f137562c = str;
                C52428rj rjVar2 = (C52428rj) riVar.build();
                boVar.copyOnWrite();
                C51718bp bpVar2 = (C51718bp) boVar.instance;
                rjVar2.getClass();
                bpVar2.f135689c = rjVar2;
                bpVar2.f135687a |= 2;
            }
        }
        C51718bp bpVar3 = (C51718bp) boVar.build();
        gVar.copyOnWrite();
        C81050h hVar5 = (C81050h) gVar.instance;
        bpVar3.getClass();
        hVar5.f222151f = bpVar3;
        hVar5.f222146a |= 16;
        C48041ab abVar2 = bxVar.f124457e;
        if (abVar2 == null) {
            abVar2 = C48041ab.f124355c;
        }
        if (!abVar2.f124358b.isEmpty()) {
            C48041ab abVar3 = bxVar.f124457e;
            if (abVar3 == null) {
                abVar3 = C48041ab.f124355c;
            }
            String str2 = abVar3.f124358b;
            gVar.copyOnWrite();
            C81050h hVar6 = (C81050h) gVar.instance;
            str2.getClass();
            hVar6.f222146a |= 64;
            hVar6.f222153h = str2;
        }
        return (C81050h) gVar.build();
    }

    /* renamed from: h */
    public final void mo88873h() {
        C59104x d = f265651a.mo56226d();
        d.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
        ((C59052c) ((C59052c) d).mo56372aa(17721)).mo56386p("#onCancelQuery");
        if (this.f265658h.isPresent()) {
            ((C94965b) this.f265658h.get()).mo88876a();
        }
        this.f265660j = false;
        this.f265663m = false;
        if (this.f265659i.isPresent()) {
            this.f265654d.c((C37672hs) this.f265659i.get());
        }
    }

    /* renamed from: i */
    public final void mo88874i() {
        if (this.f265661k.isPresent() && this.f265662l.isPresent() && this.f265670t.isPresent()) {
            this.f265666p.mo88817h(((Long) this.f265670t.get()).longValue(), ((Boolean) this.f265661k.get()).booleanValue(), ((Integer) this.f265662l.get()).intValue());
        } else if (this.f265663m) {
            this.f265666p.mo88819j(((Long) this.f265670t.get()).longValue(), ((Integer) this.f265662l.get()).intValue());
        } else {
            C59104x c = f265651a.mo56225c();
            c.mo56378ag(C58975e.f156826a, "GacsDialogHandler");
            ((C59052c) ((C59052c) c).mo56372aa(17742)).mo56386p("parameters for onQueryStarted are missing");
        }
    }

    /* renamed from: j */
    public final boolean mo88875j(C37672hs hsVar) {
        return m156783l(hsVar);
    }
}
