package com.google.android.apps.gsa.nga.engine.understanding.p6238e;

import com.google.android.apps.gsa.nga.engine.ai.a.a.bx;
import com.google.android.apps.gsa.nga.engine.ai.x;
import com.google.android.apps.gsa.nga.engine.am.q.d;
import com.google.android.apps.gsa.nga.engine.am.q.f;
import com.google.android.apps.gsa.nga.engine.annotators.C74983ae;
import com.google.android.apps.gsa.nga.engine.annotators.ak;
import com.google.android.apps.gsa.nga.engine.av.bv;
import com.google.android.apps.gsa.nga.engine.ax.c.g;
import com.google.android.apps.gsa.nga.engine.ax.c.s;
import com.google.android.apps.gsa.nga.engine.p5891ab.p5892a.C74757n;
import com.google.android.apps.gsa.nga.engine.p5897ae.C74798j;
import com.google.android.apps.gsa.nga.engine.p5913am.p5933n.C74945h;
import com.google.android.apps.gsa.nga.engine.p5913am.p5939u.C74965n;
import com.google.android.apps.gsa.nga.engine.p6026f.C75981a;
import com.google.android.apps.gsa.nga.engine.p6029g.C76092h;
import com.google.android.apps.gsa.nga.engine.p6056o.p6095g.C77381af;
import com.google.android.apps.gsa.nga.engine.p6056o.p6095g.C77385aj;
import com.google.android.apps.gsa.nga.engine.p6056o.p6095g.C77386ak;
import com.google.android.apps.gsa.nga.engine.p6056o.p6095g.C77387al;
import com.google.android.apps.gsa.nga.engine.p6056o.p6095g.C77402o;
import com.google.android.apps.gsa.nga.engine.p6056o.p6095g.C77403p;
import com.google.android.apps.gsa.nga.engine.p6056o.p6095g.C77404q;
import com.google.android.apps.gsa.nga.engine.p6260x.C79850ah;
import com.google.android.apps.gsa.nga.engine.p6260x.C79851ai;
import com.google.android.apps.gsa.nga.engine.p6260x.C79863k;
import com.google.android.apps.gsa.nga.engine.understanding.C78977ad;
import com.google.android.apps.gsa.nga.engine.understanding.C78979af;
import com.google.android.apps.gsa.nga.engine.understanding.C78983aj;
import com.google.android.apps.gsa.nga.engine.understanding.C78990aq;
import com.google.android.apps.gsa.nga.engine.understanding.C78994au;
import com.google.android.apps.gsa.nga.engine.understanding.C79004ba;
import com.google.android.apps.gsa.nga.engine.understanding.C79007bd;
import com.google.android.apps.gsa.nga.engine.understanding.C79074e;
import com.google.android.apps.gsa.nga.engine.understanding.C79141h;
import com.google.android.apps.gsa.nga.engine.understanding.C79160r;
import com.google.android.apps.gsa.nga.engine.understanding.C79161s;
import com.google.android.apps.gsa.nga.engine.understanding.C79162t;
import com.google.android.apps.gsa.nga.engine.understanding.p6239f.C79137x;
import com.google.android.apps.gsa.nga.shared.p6275aa.p6295n.C80513b;
import com.google.android.apps.gsa.nga.shared.p6407v.C83334w;
import com.google.android.apps.gsa.shared.logger.p7051b.C89849ae;
import com.google.android.apps.gsa.shared.p7066m.C89988b;
import com.google.android.apps.gsa.shared.p7066m.C90126fx;
import com.google.android.apps.gsa.shared.util.p7159c.p7160a.C90821bm;
import com.google.android.apps.gsa.shared.util.p7188v.C91142g;
import com.google.android.libraries.gsa.p1876k.C22871g;
import com.google.common.p4522b.C58370cn;
import com.google.common.p4522b.C58480gp;
import com.google.common.p4522b.C58485gu;
import com.google.common.util.concurrent.C60826bg;
import com.google.common.util.concurrent.C60870cx;
import com.google.common.util.concurrent.C60922j;
import java.util.Comparator;
import java.util.List;
import java.util.Set;
import p3186j$.util.Collection;
import p3186j$.util.Comparator;
import p3186j$.util.Objects;
import p3186j$.util.Optional;
import p3186j$.util.function.Function;
import p3186j$.util.stream.Stream;

/* renamed from: com.google.android.apps.gsa.nga.engine.understanding.e.ak */
/* compiled from: PG */
public final class C79086ak implements C78990aq {

    /* renamed from: a */
    public final C22871g f217445a;

    /* renamed from: b */
    public final Optional f217446b;

    /* renamed from: c */
    public final C79137x f217447c;

    /* renamed from: d */
    public final C75981a f217448d;

    /* renamed from: e */
    public final C83334w f217449e;

    /* renamed from: f */
    public final bv f217450f;

    /* renamed from: g */
    public final C76092h f217451g;

    /* renamed from: h */
    private final C91142g f217452h;

    /* renamed from: i */
    private final f f217453i;

    /* renamed from: j */
    private final ak f217454j;

    /* renamed from: k */
    private final C79851ai f217455k;

    /* renamed from: l */
    private final Set f217456l;

    /* renamed from: m */
    private final Set f217457m;

    /* renamed from: n */
    private final C79161s f217458n;

    /* renamed from: o */
    private final C79863k f217459o;

    /* renamed from: p */
    private final C77403p f217460p;

    /* renamed from: q */
    private final C77386ak f217461q;

    /* renamed from: r */
    private final C77381af f217462r;

    /* renamed from: s */
    private final C90821bm f217463s;

    public C79086ak(Set set, Set set2, C79161s sVar, C79137x xVar, f fVar, ak akVar, C75981a aVar, C77403p pVar, C77386ak akVar2, C77381af afVar, C91142g gVar, C22871g gVar2, C90821bm bmVar, C79851ai aiVar, C83334w wVar, Optional optional, C79863k kVar, bv bvVar, C76092h hVar) {
        this.f217456l = set;
        this.f217457m = set2;
        this.f217458n = sVar;
        this.f217447c = xVar;
        this.f217453i = fVar;
        this.f217454j = akVar;
        this.f217448d = aVar;
        this.f217460p = pVar;
        this.f217461q = akVar2;
        this.f217462r = afVar;
        this.f217452h = gVar;
        this.f217445a = gVar2;
        this.f217463s = bmVar;
        this.f217455k = aiVar;
        this.f217446b = optional;
        this.f217459o = kVar;
        this.f217449e = wVar;
        this.f217450f = bvVar;
        this.f217451g = hVar;
    }

    /* renamed from: c */
    public static final C78983aj m127021c(C80513b bVar, C74757n nVar) {
        C79074e eVar = new C79074e();
        eVar.f217428a = Optional.m71637of(bVar);
        eVar.mo73745b(nVar);
        return eVar.mo73744a();
    }

    /* renamed from: a */
    public final C78994au mo73751a(Stream stream, C74965n nVar, C74945h hVar) {
        C74965n nVar2 = nVar;
        this.f217459o.mo74237c(C89849ae.NGA_UNDERSTANDING_START, nVar.mo71336k());
        C79004ba k = C79007bd.m126949k(this.f217463s);
        C58485gu guVar = (C58485gu) stream.collect(C58370cn.f155946a);
        C77386ak akVar = this.f217461q;
        ((C77404q) akVar.f213403a.mo17428b()).getClass();
        ((C77387al) akVar.f213404b.mo17428b()).getClass();
        C74798j jVar = (C74798j) akVar.f213405c.mo17428b();
        jVar.getClass();
        bx bxVar = (bx) akVar.f213406d.mo17428b();
        bxVar.getClass();
        nVar.getClass();
        C77385aj ajVar = new C77385aj(jVar, bxVar, nVar2);
        C77402o a = this.f217460p.mo72545a(nVar2);
        Comparator reversed = Comparator.EL.reversed(Comparator.EL.thenComparing(Comparator.CC.comparing(new C79103q(ajVar), this.f217462r), (Function) C79104r.f217487a));
        C78977ad adVar = new C78977ad(this.f217445a, (int) this.f217452h.mo85399d(C90126fx.f251730oN), reversed, new C79105s(this, nVar2, ajVar));
        g gVar = new g(guVar);
        s sVar = new s(gVar);
        if (Collection.EL.stream(guVar).allMatch(C79096j.f217477a)) {
            s i = sVar.i(C79097k.f217478a);
            C79141h hVar2 = new C79141h();
            hVar2.f217546a = i;
            hVar2.f217551f = gVar;
            hVar2.f217548c = ajVar;
            hVar2.f217549d = a;
            hVar2.f217547b = adVar;
            hVar2.f217550e = k;
            return hVar2.mo73752a();
        }
        C79161s sVar2 = this.f217458n;
        x xVar = (x) sVar2.f217613a.mo17428b();
        xVar.getClass();
        C22871g gVar2 = (C22871g) sVar2.f217614b.mo17428b();
        gVar2.getClass();
        nVar.getClass();
        C79160r rVar = new C79160r(xVar, gVar2, nVar2);
        s f = sVar.c(new C79098l(this, nVar2)).f(new C79088b(this, nVar2), "[NGA] Annotate candidates.", this.f217445a, adVar, new C79089c(a), true);
        if (this.f217452h.mo85405j(C90126fx.f251320gb)) {
            C58480gp e = C58485gu.m89837e();
            for (C78979af afVar : (List) Collection.EL.stream(this.f217457m).filter(C79091e.f217468a).sorted(C79092f.f217469a).collect(C58370cn.f155946a)) {
                C79093g gVar3 = new C79093g(a, afVar);
                e.mo55395g(f.h(new C79094h(afVar, nVar2, k), "[NGA] generate rewrites.", this.f217445a, adVar, gVar3).c(new C79095i(this, nVar2)).f(new C79084ai(this, nVar2), "[NGA] Annotate rewrites.", this.f217445a, adVar, new C79085aj(a), true));
            }
            s g = s.g(C58485gu.m89847o(f.i(C79110x.f217501a), s.g(e.mo55394f())));
            C58480gp e2 = C58485gu.m89837e();
            int i2 = 1;
            e2.mo55395g(g.d(new C79090d(this), true));
            for (C79162t tVar : (List) Collection.EL.stream(this.f217456l).filter(C79112z.f217503a).sorted(new C79076aa(ajVar)).collect(C58370cn.f155946a)) {
                C79106t tVar2 = new C79106t(a, tVar);
                C78977ad adVar2 = adVar;
                C79108v vVar = new C79108v(this, tVar, nVar, hVar, k);
                Object[] objArr = new Object[i2];
                objArr[0] = Integer.valueOf(tVar.mo73713a().getNumber());
                C79108v vVar2 = vVar;
                String format = String.format("[NGA] intent generation (%s)", objArr);
                C58480gp gpVar = e2;
                gpVar.mo55395g(g.f(vVar2, format, this.f217445a, adVar2, tVar2, false).d(C79109w.f217500a, false));
                rVar = rVar;
                e2 = gpVar;
                g = g;
                gVar = gVar;
                adVar = adVar2;
                i2 = 1;
            }
            C79160r rVar2 = rVar;
            g gVar4 = gVar;
            C78977ad adVar3 = adVar;
            s e3 = s.g(e2.mo55394f()).e(new C79100n(this, nVar2), false);
            if (this.f217452h.mo85405j(C90126fx.f251271ff)) {
                Objects.requireNonNull(rVar2);
                e3 = e3.h(new C79101o(rVar2), "[NGA] Run IGDP.", this.f217445a, adVar3, new C79102p(a));
            }
            s h = e3.h(new C79107u(this, nVar2), "[NGA] UnderstandingImpl.resolve", this.f217445a, adVar3, new C79079ad(a));
            C79141h hVar3 = new C79141h();
            hVar3.f217548c = ajVar;
            hVar3.f217549d = a;
            hVar3.f217551f = gVar4;
            hVar3.f217547b = adVar3;
            hVar3.f217546a = h;
            hVar3.f217550e = k;
            return hVar3.mo73752a();
        }
        s i3 = f.i(C79099m.f217481a);
        C79141h hVar4 = new C79141h();
        hVar4.f217546a = i3;
        hVar4.f217551f = gVar;
        hVar4.f217548c = ajVar;
        hVar4.f217549d = a;
        hVar4.f217547b = adVar;
        hVar4.f217550e = k;
        return hVar4.mo73752a();
    }

    /* renamed from: b */
    public final C60870cx mo73800b(C74757n nVar, C74965n nVar2) {
        C79850ah c = this.f217455k.mo74252c(3, nVar2.mo71336k());
        try {
            if (this.f217452h.mo85405j(C90126fx.f251732oP)) {
                this.f217453i.c(d.a).map(C79083ah.f217441a);
            } else {
                Optional.empty();
            }
            C60870cx c2 = this.f217454j.c(nVar.mo71152e().mo71141c().mo71146c(), C74983ae.m121217a(nVar2.mo71326a()));
            boolean anyMatch = Collection.EL.stream(C89988b.m146551d(this.f217451g.mo72021b().mo72035a().mo71523c())).anyMatch(new C79080ae(this));
            if (this.f217451g.mo72021b().mo72035a().mo71529i() && anyMatch) {
                c2 = this.f217445a.mo28209i(c2, "[NGA] UnderstandingAsyncImpl create unintended annotation", new C79081af(this, nVar, nVar2));
            }
            Objects.requireNonNull(nVar);
            C60870cx g = C60922j.m93044g(c2, new C79082ag(nVar), C60826bg.f164896a);
            c.mo74256c(g);
            if (c != null) {
                c.mo74255b();
            }
            return g;
        } catch (Throwable th) {
            try {
                Throwable.class.getDeclaredMethod("addSuppressed", new Class[]{Throwable.class}).invoke(th, new Object[]{th});
            } catch (Exception unused) {
            }
        }
        throw th;
    }
}
