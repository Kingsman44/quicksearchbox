package com.google.android.apps.search.assistant.surfaces.voice.p9785ui.immersivecanvas.webapp;

import android.util.Base64;
import com.google.android.apps.search.assistant.surfaces.voice.controller.p9532ui.actions.C127118j;
import com.google.android.apps.search.assistant.surfaces.voice.p9539d.p9581g.C127353a;
import com.google.android.apps.search.assistant.surfaces.voice.p9590e.C127407d;
import com.google.android.apps.search.assistant.surfaces.voice.p9591f.p9592a.p9600g.C127454b;
import com.google.android.apps.search.assistant.surfaces.voice.p9785ui.immersivecanvas.p9847c.C129754b;
import com.google.android.apps.search.assistant.surfaces.voice.p9785ui.immersivecanvas.webapp.p9852b.p9853a.C129819a;
import com.google.android.apps.search.assistant.surfaces.voice.p9785ui.immersivecanvas.webapp.p9852b.p9853a.C129830f;
import com.google.android.apps.search.assistant.surfaces.voice.p9785ui.immersivecanvas.webapp.p9852b.p9853a.C129833i;
import com.google.android.apps.search.assistant.surfaces.voice.p9785ui.immersivecanvas.webapp.p9852b.p9853a.C129834j;
import com.google.android.libraries.assistant.p1363c.p1398g.C17360b;
import com.google.android.libraries.assistant.p1363c.p1398g.p1402b.p1403a.C17361a;
import com.google.android.libraries.assistant.p1363c.p1398g.p1436k.C17478an;
import com.google.android.libraries.assistant.p1363c.p1398g.p1436k.C17479ao;
import com.google.android.libraries.assistant.p1363c.p1398g.p1436k.C17482ar;
import com.google.android.libraries.assistant.p1363c.p1398g.p1436k.C17484at;
import com.google.android.libraries.assistant.p1363c.p1398g.p1436k.C17485au;
import com.google.android.libraries.assistant.p1363c.p1398g.p1436k.C17497bf;
import com.google.android.libraries.assistant.p1363c.p1398g.p1436k.C17499bh;
import com.google.android.libraries.web.postmessage.C43951b;
import com.google.android.libraries.web.postmessage.internal.C43968o;
import com.google.apps.tiktok.concurrent.futuresmixin.C46438d;
import com.google.apps.tiktok.concurrent.futuresmixin.C46439e;
import com.google.apps.tiktok.tracing.C47810es;
import com.google.assistant.p3897e.p3921j.C51682amp;
import com.google.assistant.p3897e.p3921j.amm;
import com.google.assistant.p3897e.p3921j.amo;
import com.google.assistant.p3897e.p3921j.p3926e.C51876cj;
import com.google.assistant.p3897e.p3921j.p3926e.C51880cn;
import com.google.assistant.p3897e.p3921j.p3926e.C51885cs;
import com.google.assistant.p3897e.p3929l.p3930a.C52795w;
import com.google.assistant.p3897e.p3929l.p3930a.C52796x;
import com.google.common.p4522b.C58485gu;
import com.google.common.p4526f.C59052c;
import com.google.common.util.concurrent.C60856cj;
import com.google.common.util.concurrent.C60872cz;
import com.google.protobuf.C62921ba;
import com.google.protobuf.C62942bv;
import com.google.protobuf.C62974ct;
import com.google.protos.p5068j.p5069a.p5070a.p5071a.p5076b.p5077a.p5093b.p5094a.p5099b.p5100a.p5103b.p5104a.C65507aa;
import com.google.protos.p5068j.p5069a.p5070a.p5071a.p5076b.p5077a.p5093b.p5094a.p5099b.p5100a.p5103b.p5104a.C65510ad;
import com.google.protos.p5068j.p5069a.p5070a.p5071a.p5076b.p5077a.p5093b.p5094a.p5099b.p5100a.p5103b.p5104a.C65511ae;
import com.google.protos.p5068j.p5069a.p5070a.p5071a.p5076b.p5077a.p5093b.p5094a.p5099b.p5100a.p5103b.p5104a.C65515ai;
import com.google.protos.p5068j.p5069a.p5070a.p5071a.p5076b.p5077a.p5093b.p5094a.p5099b.p5100a.p5103b.p5104a.C65520d;
import com.google.protos.p5068j.p5069a.p5070a.p5071a.p5076b.p5077a.p5093b.p5094a.p5099b.p5100a.p5103b.p5104a.C65524h;
import com.google.protos.p5068j.p5069a.p5070a.p5071a.p5076b.p5077a.p5093b.p5094a.p5099b.p5100a.p5103b.p5104a.C65525i;
import com.google.protos.p5068j.p5069a.p5070a.p5071a.p5076b.p5077a.p5093b.p5094a.p5099b.p5100a.p5103b.p5104a.C65529m;
import com.google.protos.p5068j.p5069a.p5070a.p5071a.p5076b.p5077a.p5093b.p5094a.p5099b.p5100a.p5103b.p5104a.C65533q;
import com.google.protos.p5068j.p5069a.p5070a.p5071a.p5076b.p5077a.p5093b.p5094a.p5099b.p5100a.p5103b.p5104a.C65535s;
import com.google.protos.p5068j.p5069a.p5070a.p5071a.p5076b.p5077a.p5093b.p5094a.p5099b.p5100a.p5103b.p5104a.C65537u;
import com.google.protos.p5068j.p5069a.p5070a.p5071a.p5076b.p5077a.p5093b.p5094a.p5099b.p5100a.p5103b.p5104a.C65542z;
import com.google.speech.p5224k.p5225a.C67187ae;
import com.google.speech.p5224k.p5225a.C67190ah;
import org.json.JSONException;
import org.json.JSONObject;
import p3186j$.util.Optional;
import p5462h.p5473f.p5475b.C69664n;

/* renamed from: com.google.android.apps.search.assistant.surfaces.voice.ui.immersivecanvas.webapp.d */
/* compiled from: PG */
public final /* synthetic */ class C129837d implements C43951b {

    /* renamed from: a */
    public final /* synthetic */ CanvasWebAppFragmentPeer f356231a;

    public /* synthetic */ C129837d(CanvasWebAppFragmentPeer canvasWebAppFragmentPeer) {
        this.f356231a = canvasWebAppFragmentPeer;
    }

    /* renamed from: a */
    public final void mo42607a(JSONObject jSONObject, C43968o oVar) {
        C65537u uVar;
        C65529m mVar;
        C65533q qVar;
        amo amo;
        C65535s sVar;
        CanvasWebAppFragmentPeer canvasWebAppFragmentPeer = this.f356231a;
        try {
            C65525i iVar = (C65525i) C62942bv.parseFrom((C62942bv) C65525i.f178097c, Base64.decode(jSONObject.getString("protoAsBase64"), 0), C62921ba.m95368a());
            C69664n.m101061g(iVar, "value");
            ((C59052c) ((C59052c) CanvasWebAppFragmentPeer.f356144a.mo56224b()).mo56372aa(38486)).mo56389s("Received newMessage from WebApp : %s", new C129754b(iVar));
            C129841h hVar = C129841h.NO_CONTENT;
            int i = iVar.f178099a;
            int a = C65524h.m96712a(i);
            int i2 = a - 1;
            if (a != 0) {
                switch (i2) {
                    case 0:
                        canvasWebAppFragmentPeer.mo109273h(canvasWebAppFragmentPeer.mo109269b(), oVar);
                        return;
                    case 1:
                        if (i == 2) {
                            uVar = (C65537u) iVar.f178100b;
                        } else {
                            uVar = C65537u.f178116b;
                        }
                        canvasWebAppFragmentPeer.f356159m.mo109282e(uVar.f178118a);
                        return;
                    case 2:
                        C129842i iVar2 = (C129842i) canvasWebAppFragmentPeer.f356162p.get();
                        iVar2.f356239a.set(C129841h.LOADED);
                        C60872cz czVar = iVar2.f356241c.f356164r;
                        if (czVar != null) {
                            czVar.cancel(false);
                            iVar2.f356241c.f356164r = null;
                        }
                        C58485gu a2 = canvasWebAppFragmentPeer.f356159m.mo109278a();
                        int size = a2.size();
                        for (int i3 = 0; i3 < size; i3++) {
                            C65515ai aiVar = (C65515ai) a2.get(i3);
                            C65542z zVar = (C65542z) C65507aa.f178066c.createBuilder();
                            zVar.copyOnWrite();
                            C65507aa aaVar = (C65507aa) zVar.instance;
                            aiVar.getClass();
                            aaVar.f178069b = aiVar;
                            aaVar.f178068a = 2;
                            canvasWebAppFragmentPeer.mo109273h((C65507aa) zVar.build(), oVar);
                        }
                        return;
                    case 3:
                        if (i == 4) {
                            mVar = (C65529m) iVar.f178100b;
                        } else {
                            mVar = C65529m.f178103d;
                        }
                        if (!canvasWebAppFragmentPeer.f356157k.mo109219a().f356049a && !canvasWebAppFragmentPeer.f356157k.mo109220b()) {
                            CanvasWebAppViewModel canvasWebAppViewModel = canvasWebAppFragmentPeer.f356170x;
                            canvasWebAppViewModel.getClass();
                            if (!canvasWebAppViewModel.f356177b) {
                                C51885cs csVar = canvasWebAppFragmentPeer.f356171y.f178090a;
                                if (csVar == null) {
                                    csVar = C51885cs.f136078y;
                                }
                                C51880cn cnVar = csVar.f136087f;
                                if (cnVar == null) {
                                    cnVar = C51880cn.f136067c;
                                }
                                C129819a aVar = canvasWebAppViewModel.f356176a;
                                ((C129834j) aVar).f356221b.mo109227a();
                                ((C129834j) aVar).f356221b.mo109228b(mVar.f178106b);
                                ((C129834j) aVar).f356221b.f356054c.set(mVar.f178105a);
                                C17361a aVar2 = ((C129834j) aVar).f356224e;
                                String str = mVar.f178107c;
                                C17497bf bfVar = (C17497bf) C17499bh.f50509e.createBuilder();
                                bfVar.copyOnWrite();
                                C17499bh bhVar = (C17499bh) bfVar.instance;
                                bhVar.f50511a |= 8;
                                bhVar.f50514d = true;
                                C17478an anVar = (C17478an) C17479ao.f50468d.createBuilder();
                                C17482ar arVar = (C17482ar) C17485au.f50481h.createBuilder();
                                C17484at atVar = C17484at.SERVER;
                                arVar.copyOnWrite();
                                C17485au auVar = (C17485au) arVar.instance;
                                auVar.f50486d = atVar.f50480d;
                                auVar.f50483a = 8 | auVar.f50483a;
                                C67187ae aeVar = (C67187ae) C67190ah.f182619q.createBuilder();
                                String str2 = cnVar.f136069a;
                                aeVar.copyOnWrite();
                                C67190ah ahVar = (C67190ah) aeVar.instance;
                                str2.getClass();
                                ahVar.f182622a |= 8192;
                                ahVar.f182632k = str2;
                                String str3 = cnVar.f136070b;
                                aeVar.copyOnWrite();
                                C67190ah ahVar2 = (C67190ah) aeVar.instance;
                                str3.getClass();
                                ahVar2.f182622a |= 16384;
                                ahVar2.f182633l = str3;
                                aeVar.copyOnWrite();
                                C67190ah ahVar3 = (C67190ah) aeVar.instance;
                                ahVar3.f182628g = 4;
                                ahVar3.f182622a |= 128;
                                if (!str.contains("<speak>")) {
                                    str = "<speak>" + str + "</speak>";
                                }
                                aeVar.copyOnWrite();
                                C67190ah ahVar4 = (C67190ah) aeVar.instance;
                                str.getClass();
                                ahVar4.f182622a |= 2;
                                ahVar4.f182626e = str;
                                if (str.contains("<mark")) {
                                    aeVar.copyOnWrite();
                                    C67190ah ahVar5 = (C67190ah) aeVar.instance;
                                    ahVar5.f182637p = 3;
                                    ahVar5.f182622a |= 134217728;
                                }
                                C67190ah ahVar6 = (C67190ah) aeVar.build();
                                arVar.copyOnWrite();
                                C17485au auVar2 = (C17485au) arVar.instance;
                                ahVar6.getClass();
                                auVar2.f50485c = ahVar6;
                                auVar2.f50484b = 3;
                                C52795w wVar = (C52795w) C52796x.f138517c.createBuilder();
                                wVar.mo53910a(cnVar.f136069a);
                                arVar.copyOnWrite();
                                C17485au auVar3 = (C17485au) arVar.instance;
                                C52796x xVar = (C52796x) wVar.build();
                                xVar.getClass();
                                auVar3.f50487e = xVar;
                                auVar3.f50483a |= 16;
                                anVar.copyOnWrite();
                                C17479ao aoVar = (C17479ao) anVar.instance;
                                C17485au auVar4 = (C17485au) arVar.build();
                                auVar4.getClass();
                                aoVar.f50471b = auVar4;
                                aoVar.f50470a |= 1;
                                bfVar.copyOnWrite();
                                C17499bh bhVar2 = (C17499bh) bfVar.instance;
                                C17479ao aoVar2 = (C17479ao) anVar.build();
                                aoVar2.getClass();
                                bhVar2.f50513c = aoVar2;
                                bhVar2.f50512b = 3;
                                C17360b a3 = aVar2.mo23306a((C17499bh) bfVar.build());
                                C60856cj.m92911t(a3.mo23302a().mo23276b(), C47810es.m84974n(new C129830f((C129834j) aVar, a3)), ((C129834j) aVar).f356222c);
                                C60856cj.m92911t(a3.mo23304c(), C47810es.m84974n(new C129833i((C129834j) aVar, a3)), ((C129834j) aVar).f356222c);
                                return;
                            }
                        }
                        C65542z zVar2 = (C65542z) C65507aa.f178066c.createBuilder();
                        C65510ad adVar = (C65510ad) C65511ae.f178074c.createBuilder();
                        String str4 = mVar.f178105a;
                        adVar.copyOnWrite();
                        str4.getClass();
                        ((C65511ae) adVar.instance).f178076a = str4;
                        adVar.copyOnWrite();
                        ((C65511ae) adVar.instance).f178077b = "BLOCKED";
                        C65511ae aeVar2 = (C65511ae) adVar.build();
                        zVar2.copyOnWrite();
                        C65507aa aaVar2 = (C65507aa) zVar2.instance;
                        aeVar2.getClass();
                        aaVar2.f178069b = aeVar2;
                        aaVar2.f178068a = 4;
                        canvasWebAppFragmentPeer.mo109273h((C65507aa) zVar2.build(), oVar);
                        return;
                    case 4:
                        if (i == 5) {
                            qVar = (C65533q) iVar.f178100b;
                        } else {
                            qVar = C65533q.f178110b;
                        }
                        ((C59052c) ((C59052c) CanvasWebAppFragmentPeer.f356144a.mo56224b()).mo56372aa(38482)).mo56389s("onSendTextQuery sendTextQuery:%s", qVar.f178112a);
                        if (!canvasWebAppFragmentPeer.f356157k.mo109219a().f356049a) {
                            CanvasWebAppViewModel canvasWebAppViewModel2 = canvasWebAppFragmentPeer.f356170x;
                            canvasWebAppViewModel2.getClass();
                            if (!canvasWebAppViewModel2.f356177b) {
                                canvasWebAppFragmentPeer.f356158l.mo109226b(true);
                                canvasWebAppFragmentPeer.f356155i.mo107935k();
                                CanvasWebAppViewModel canvasWebAppViewModel3 = canvasWebAppFragmentPeer.f356170x;
                                canvasWebAppViewModel3.getClass();
                                ((C129834j) canvasWebAppViewModel3.f356176a).f356224e.mo23308c();
                                C46439e eVar = canvasWebAppFragmentPeer.f356154h;
                                C127118j jVar = canvasWebAppFragmentPeer.f356155i;
                                C127454b bVar = C127454b.CLIENT_INPUT;
                                amm amm = (amm) C51682amp.f135384d.createBuilder();
                                String str5 = qVar.f178112a;
                                amm.copyOnWrite();
                                C51682amp amp = (C51682amp) amm.instance;
                                str5.getClass();
                                amp.f135386a |= 1;
                                amp.f135387b = str5;
                                C51885cs csVar2 = canvasWebAppFragmentPeer.f356171y.f178090a;
                                if (csVar2 == null) {
                                    csVar2 = C51885cs.f136078y;
                                }
                                int a4 = C51876cj.m86404a(csVar2.f136086e);
                                if (a4 == 0) {
                                    a4 = 1;
                                }
                                if (a4 - 1 != 1) {
                                    amo = amo.UNTRUSTED;
                                } else {
                                    amo = amo.TRUSTED;
                                }
                                amm.copyOnWrite();
                                C51682amp amp2 = (C51682amp) amm.instance;
                                amp2.f135388c = amo.f135383d;
                                amp2.f135386a |= 2;
                                eVar.mo50428h(C46438d.m82810b(jVar.mo107931g(C127407d.m208363c(bVar, (C51682amp) amm.build()))).f121541a, (Object) null, canvasWebAppFragmentPeer.f356156j);
                                return;
                            }
                        }
                        canvasWebAppFragmentPeer.mo109275j(4);
                        ((C59052c) ((C59052c) CanvasWebAppFragmentPeer.f356144a.mo56224b()).mo56372aa(38483)).mo56386p("onSendTextQuery blocked");
                        return;
                    case 5:
                        if (i == 6) {
                            C65520d dVar = (C65520d) iVar.f178100b;
                        } else {
                            C65520d dVar2 = C65520d.f178092b;
                        }
                        canvasWebAppFragmentPeer.f356169w.mo109262g();
                        return;
                    case 6:
                        ((C59052c) ((C59052c) CanvasWebAppFragmentPeer.f356144a.mo56224b()).mo56372aa(38481)).mo56386p("Stopping CMM as requested by the web app");
                        canvasWebAppFragmentPeer.f356148B.mo109206a();
                        return;
                    case 7:
                        C127353a aVar3 = canvasWebAppFragmentPeer.f356167u;
                        if (i == 8) {
                            sVar = (C65535s) iVar.f178100b;
                        } else {
                            sVar = C65535s.f178113b;
                        }
                        String str6 = sVar.f178115a;
                        ((C59052c) ((C59052c) C127353a.f350711a.mo56224b()).mo56372aa(37298)).mo56389s("Updating canvas state to: %s ", str6);
                        aVar3.f350712b.set(Optional.m71637of(str6));
                        return;
                    default:
                        return;
                }
                ((C59052c) ((C59052c) ((C59052c) CanvasWebAppFragmentPeer.f356144a.mo56226d()).mo56382g(e)).mo56372aa(38487)).mo56386p("Failed to parse message from WebApp.");
            }
            throw null;
        } catch (C62974ct | JSONException e) {
            ((C59052c) ((C59052c) ((C59052c) CanvasWebAppFragmentPeer.f356144a.mo56226d()).mo56382g(e)).mo56372aa(38487)).mo56386p("Failed to parse message from WebApp.");
        }
    }
}
